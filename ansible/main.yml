```yaml
---
# Nombre: ansible_manage_users.yml
# Playbook Ansible para crear un usuario, añadirlo a un grupo y configurar SSH Keys

- hosts: all
  become: true # Ejecutar tareas con privilegios de root

  vars:
    new_user_name: appuser
    new_user_group: sudo # O 'docker', 'www-data', etc.
    ssh_key_content: "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQ..." # ¡REEMPLAZA con tu clave pública SSH real!

  tasks:
    - name: Crear grupo "{{ new_user_group }}" si no existe
      group:
        name: "{{ new_user_group }}"
        state: present

    - name: Crear usuario "{{ new_user_name }}"
      user:
        name: "{{ new_user_name }}"
        group: "{{ new_user_group }}"
        groups: "{{ new_user_group }}" # Asegura que el usuario sea parte del grupo
        append: yes # Añadir a grupos existentes si ya es miembro
        shell: /bin/bash # Shell por defecto
        create_home: yes # Crear directorio home
        state: present

    - name: Crear directorio .ssh para el nuevo usuario
      file:
        path: "/home/{{ new_user_name }}/.ssh"
        state: directory
        owner: "{{ new_user_name }}"
        group: "{{ new_user_name }}"
        mode: '0700'

    - name: Añadir clave pública SSH para el nuevo usuario
      copy:
        content: "{{ ssh_key_content }}"
        dest: "/home/{{ new_user_name }}/.ssh/authorized_keys"
        owner: "{{ new_user_name }}"
        group: "{{ new_user_name }}"
        mode: '0600'
```

```yaml
---
# Nombre: ansible_install_monitoring_tools.yml
# Playbook Ansible para instalar herramientas de monitoreo básicas (htop, iftop, iotop)
# compatible con sistemas basados en Debian y RedHat.

- hosts: monitoring_targets
  become: true

  vars:
    monitoring_packages:
      - htop
      - iftop
      - iotop
      - sysstat # Para herramientas como iostat, mpstat

  tasks:
    - name: Actualizar caché de apt (Debian/Ubuntu)
      apt:
        update_cache: yes
      when: ansible_os_family == "Debian"

    - name: Instalar paquetes de monitoreo (Debian/Ubuntu)
      apt:
        name: "{{ monitoring_packages }}"
        state: present
      when: ansible_os_family == "Debian"

    - name: Actualizar caché de yum/dnf (RedHat/CentOS/Fedora)
      yum:
        update_cache: yes
      when: ansible_os_family == "RedHat"

    - name: Instalar paquetes de monitoreo (RedHat/CentOS/Fedora)
      yum:
        name: "{{ monitoring_packages }}"
        state: present
      when: ansible_os_family == "RedHat"
```

```yaml
---
# Nombre: ansible_configure_application_settings.yml
# Playbook Ansible para configurar un archivo de propiedades de aplicación y reiniciar el servicio

- hosts: app_servers
  become: true

  vars:
    app_config_path: /etc/myapp/application.properties
    app_service_name: myapp
    db_host: db.example.com
    db_port: 5432
    db_user: appuser
    db_name: mydatabase

  tasks:
    - name: Crear directorio de configuración de la aplicación si no existe
      file:
        path: /etc/myapp
        state: directory
        owner: root
        group: root
        mode: '0755'

    - name: Generar archivo de configuración de la aplicación
      template:
        src: templates/application.properties.j2 # Necesitarás crear este archivo template
        dest: "{{ app_config_path }}"
        owner: myappuser # Usuario bajo el que se ejecuta la app
        group: myappgroup # Grupo bajo el que se ejecuta la app
        mode: '0640'
      notify:
        - Reiniciar servicio de aplicación

    - name: Asegurar que el servicio de la aplicación esté iniciado
      systemd:
        name: "{{ app_service_name }}"
        state: started
        enabled: yes

  handlers:
    - name: Reiniciar servicio de aplicación
      systemd:
        name: "{{ app_service_name }}"
        state: restarted
```